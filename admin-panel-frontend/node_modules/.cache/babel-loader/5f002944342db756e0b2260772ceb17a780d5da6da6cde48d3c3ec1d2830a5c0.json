{"ast":null,"code":"/**\r\n * API Client Configuration for Admin Panel\r\n * Connects React frontend to FastAPI backend\r\n */\n\n// Auto-detect API URL based on hostname\nconst getAPIBaseURL = () => {\n  if (process.env.REACT_APP_API_URL) {\n    return process.env.REACT_APP_API_URL;\n  }\n\n  // If accessing via Tailscale hostname, use the backend's Tailscale address\n  const hostname = window.location.hostname;\n  if (hostname === 'home-hub' || hostname.includes('taimen-godzilla.ts.net')) {\n    return 'http://home-hub-1:8000/api';\n  }\n\n  // If accessing via Tailscale IP (100.x.x.x), use backend's Tailscale IP\n  if (hostname.startsWith('100.')) {\n    return 'http://100.96.169.36:8000/api';\n  }\n\n  // Default to localhost for local development (host port maps 8087->8000)\n  return 'http://localhost:8087/api';\n};\nconst getWSURL = () => {\n  if (process.env.REACT_APP_WS_URL) {\n    return process.env.REACT_APP_WS_URL;\n  }\n  const hostname = window.location.hostname;\n  if (hostname === 'home-hub' || hostname.includes('taimen-godzilla.ts.net')) {\n    return 'ws://home-hub-1:8000/ws';\n  }\n  if (hostname.startsWith('100.')) {\n    return 'ws://100.96.169.36:8000/ws';\n  }\n\n  // Default to localhost websocket (host port maps 8087->8000)\n  return 'ws://localhost:8087/ws';\n};\nconst API_BASE_URL = getAPIBaseURL();\nconst WS_URL = getWSURL();\n\n// Token management\nconst TOKEN_KEY = 'admin_panel_token';\nexport const getToken = () => localStorage.getItem(TOKEN_KEY);\nexport const setToken = token => localStorage.setItem(TOKEN_KEY, token);\nexport const removeToken = () => localStorage.removeItem(TOKEN_KEY);\n\n/**\r\n * Make authenticated API request\r\n */\nexport const apiRequest = async (endpoint, options = {}) => {\n  const token = getToken();\n  const config = {\n    ...options,\n    headers: {\n      'Content-Type': 'application/json',\n      ...(token && {\n        'Authorization': `Bearer ${token}`\n      }),\n      ...options.headers\n    }\n  };\n  try {\n    const response = await fetch(`${API_BASE_URL}${endpoint}`, config);\n\n    // Handle 401 - only redirect to login if not on Tailscale\n    if (response.status === 401) {\n      const hostname = window.location.hostname;\n      const isTailscale = hostname === 'home-hub' || hostname.includes('taimen-godzilla.ts.net') || hostname.startsWith('100.');\n      removeToken();\n\n      // Don't redirect on Tailscale - auto-login will handle it\n      if (!isTailscale) {\n        window.location.href = '/login';\n      }\n      throw new Error('Session expired. Please login again.');\n    }\n    if (!response.ok) {\n      const error = await response.json().catch(() => ({\n        message: 'Request failed'\n      }));\n      throw new Error(error.message || `HTTP ${response.status}`);\n    }\n    return await response.json();\n  } catch (error) {\n    console.error('API Error:', error);\n    throw error;\n  }\n};\n\n/**\r\n * API Methods\r\n */\nexport const api = {\n  // Authentication\n  auth: {\n    login: async (email, password) => {\n      const response = await apiRequest('/auth/login', {\n        method: 'POST',\n        body: JSON.stringify({\n          email,\n          password\n        })\n      });\n      if (response.access_token) {\n        setToken(response.access_token);\n      }\n      return response;\n    },\n    logout: async () => {\n      await apiRequest('/auth/logout', {\n        method: 'POST'\n      });\n      removeToken();\n    },\n    getProfile: async () => {\n      return await apiRequest('/auth/profile');\n    }\n  },\n  // Users\n  users: {\n    getAll: async () => {\n      return await apiRequest('/users');\n    },\n    getById: async id => {\n      return await apiRequest(`/users/${id}`);\n    },\n    create: async userData => {\n      return await apiRequest('/users', {\n        method: 'POST',\n        body: JSON.stringify(userData)\n      });\n    },\n    update: async (id, userData) => {\n      return await apiRequest(`/users/${id}`, {\n        method: 'PUT',\n        body: JSON.stringify(userData)\n      });\n    },\n    delete: async id => {\n      return await apiRequest(`/users/${id}`, {\n        method: 'DELETE'\n      });\n    },\n    suspend: async id => {\n      return await apiRequest(`/users/${id}/suspend`, {\n        method: 'PATCH'\n      });\n    },\n    activate: async id => {\n      return await apiRequest(`/users/${id}/activate`, {\n        method: 'PATCH'\n      });\n    }\n  },\n  // Chat\n  chat: {\n    getThreads: async () => {\n      return await apiRequest('/chat/threads');\n    },\n    createThread: async threadData => {\n      return await apiRequest('/chat/threads', {\n        method: 'POST',\n        body: JSON.stringify(threadData)\n      });\n    },\n    getMessages: async threadId => {\n      return await apiRequest(`/chat/threads/${threadId}/messages`);\n    },\n    sendMessage: async (threadId, text) => {\n      return await apiRequest(`/chat/threads/${threadId}/messages`, {\n        method: 'POST',\n        body: JSON.stringify({\n          text,\n          threadId\n        })\n      });\n    },\n    deleteThread: async threadId => {\n      return await apiRequest(`/chat/threads/${threadId}`, {\n        method: 'DELETE'\n      });\n    }\n  },\n  // Invites\n  invites: {\n    getAll: async () => {\n      return await apiRequest('/invites');\n    },\n    create: async (maxUses = 5) => {\n      return await apiRequest('/invites', {\n        method: 'POST',\n        body: JSON.stringify({\n          max_uses: maxUses\n        })\n      });\n    },\n    revoke: async id => {\n      return await apiRequest(`/invites/${id}/revoke`, {\n        method: 'PATCH'\n      });\n    },\n    delete: async id => {\n      return await apiRequest(`/invites/${id}`, {\n        method: 'DELETE'\n      });\n    }\n  },\n  // Connections\n  connections: {\n    getAll: async () => {\n      return await apiRequest('/connections');\n    },\n    updateTailscale: async config => {\n      return await apiRequest('/connections/tailscale', {\n        method: 'PUT',\n        body: JSON.stringify(config)\n      });\n    },\n    testTailscale: async () => {\n      return await apiRequest('/connections/tailscale/test', {\n        method: 'POST'\n      });\n    },\n    updateOpenAI: async config => {\n      return await apiRequest('/connections/openai', {\n        method: 'PUT',\n        body: JSON.stringify(config)\n      });\n    },\n    testOpenAI: async () => {\n      return await apiRequest('/connections/openai/test', {\n        method: 'POST'\n      });\n    },\n    updateOllama: async config => {\n      return await apiRequest('/connections/ollama', {\n        method: 'PUT',\n        body: JSON.stringify(config)\n      });\n    },\n    testOllama: async () => {\n      return await apiRequest('/connections/ollama/test', {\n        method: 'POST'\n      });\n    }\n  },\n  // Cloud Storage\n  storage: {\n    getConfig: async () => {\n      return await apiRequest('/storage/config');\n    },\n    updateConfig: async config => {\n      return await apiRequest('/storage/config', {\n        method: 'PUT',\n        body: JSON.stringify(config)\n      });\n    },\n    listFiles: async (path = '/') => {\n      return await apiRequest(`/storage/files?path=${encodeURIComponent(path)}`);\n    },\n    uploadFile: async (file, path = '/') => {\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('path', path);\n      const token = getToken();\n      const response = await fetch(`${API_BASE_URL}/storage/upload`, {\n        method: 'POST',\n        headers: {\n          ...(token && {\n            'Authorization': `Bearer ${token}`\n          })\n        },\n        body: formData\n      });\n      if (!response.ok) throw new Error('Upload failed');\n      return await response.json();\n    },\n    deleteFile: async fileId => {\n      return await apiRequest(`/storage/files/${fileId}`, {\n        method: 'DELETE'\n      });\n    }\n  },\n  // Settings\n  settings: {\n    get: async () => {\n      return await apiRequest('/settings');\n    },\n    update: async settings => {\n      return await apiRequest('/settings', {\n        method: 'PUT',\n        body: JSON.stringify(settings)\n      });\n    },\n    sendNotification: async (message, target = 'all') => {\n      return await apiRequest('/settings/notifications/send', {\n        method: 'POST',\n        body: JSON.stringify({\n          message,\n          target\n        })\n      });\n    }\n  },\n  // System\n  system: {\n    getHealth: async () => {\n      return await apiRequest('/system/health');\n    },\n    getLogs: async (limit = 100) => {\n      return await apiRequest(`/system/logs?limit=${limit}`);\n    },\n    restart: async () => {\n      return await apiRequest('/system/restart', {\n        method: 'POST'\n      });\n    },\n    backup: async () => {\n      return await apiRequest('/system/backup', {\n        method: 'POST'\n      });\n    },\n    getMetrics: async () => {\n      return await apiRequest('/system/metrics');\n    }\n  }\n};\n\n/**\r\n * WebSocket Connection Manager\r\n */\nexport class WebSocketManager {\n  constructor() {\n    this.socket = null;\n    this.listeners = new Map();\n  }\n  connect(onMessage) {\n    const token = getToken();\n    if (!token) {\n      console.warn('No token available for WebSocket connection');\n      return;\n    }\n    this.socket = new WebSocket(`${WS_URL}?token=${token}`);\n    this.socket.onopen = () => {\n      console.log('✅ WebSocket connected');\n    };\n    this.socket.onmessage = event => {\n      try {\n        const data = JSON.parse(event.data);\n        if (onMessage) onMessage(data);\n\n        // Notify listeners\n        this.listeners.forEach(callback => callback(data));\n      } catch (error) {\n        console.error('WebSocket message error:', error);\n      }\n    };\n    this.socket.onerror = error => {\n      console.error('WebSocket error:', error);\n    };\n    this.socket.onclose = () => {\n      console.log('❌ WebSocket disconnected');\n      // Attempt reconnect after 3 seconds\n      setTimeout(() => this.connect(onMessage), 3000);\n    };\n  }\n  send(type, data) {\n    if (this.socket && this.socket.readyState === WebSocket.OPEN) {\n      this.socket.send(JSON.stringify({\n        type,\n        data\n      }));\n    } else {\n      console.warn('WebSocket not connected');\n    }\n  }\n  addListener(id, callback) {\n    this.listeners.set(id, callback);\n  }\n  removeListener(id) {\n    this.listeners.delete(id);\n  }\n  disconnect() {\n    if (this.socket) {\n      this.socket.close();\n      this.socket = null;\n    }\n  }\n}\nexport default api;","map":{"version":3,"names":["getAPIBaseURL","process","env","REACT_APP_API_URL","hostname","window","location","includes","startsWith","getWSURL","REACT_APP_WS_URL","API_BASE_URL","WS_URL","TOKEN_KEY","getToken","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","apiRequest","endpoint","options","config","headers","response","fetch","status","isTailscale","href","Error","ok","error","json","catch","message","console","api","auth","login","email","password","method","body","JSON","stringify","access_token","logout","getProfile","users","getAll","getById","id","create","userData","update","delete","suspend","activate","chat","getThreads","createThread","threadData","getMessages","threadId","sendMessage","text","deleteThread","invites","maxUses","max_uses","revoke","connections","updateTailscale","testTailscale","updateOpenAI","testOpenAI","updateOllama","testOllama","storage","getConfig","updateConfig","listFiles","path","encodeURIComponent","uploadFile","file","formData","FormData","append","deleteFile","fileId","settings","get","sendNotification","target","system","getHealth","getLogs","limit","restart","backup","getMetrics","WebSocketManager","constructor","socket","listeners","Map","connect","onMessage","warn","WebSocket","onopen","log","onmessage","event","data","parse","forEach","callback","onerror","onclose","setTimeout","send","type","readyState","OPEN","addListener","set","removeListener","disconnect","close"],"sources":["C:/Users/Chance/Downloads/admin-panel-frontend/src/api/apiClient.js"],"sourcesContent":["/**\r\n * API Client Configuration for Admin Panel\r\n * Connects React frontend to FastAPI backend\r\n */\r\n\r\n// Auto-detect API URL based on hostname\r\nconst getAPIBaseURL = () => {\r\n    if (process.env.REACT_APP_API_URL) {\r\n        return process.env.REACT_APP_API_URL;\r\n    }\r\n\r\n    // If accessing via Tailscale hostname, use the backend's Tailscale address\r\n    const hostname = window.location.hostname;\r\n    if (hostname === 'home-hub' || hostname.includes('taimen-godzilla.ts.net')) {\r\n        return 'http://home-hub-1:8000/api';\r\n    }\r\n\r\n    // If accessing via Tailscale IP (100.x.x.x), use backend's Tailscale IP\r\n    if (hostname.startsWith('100.')) {\r\n        return 'http://100.96.169.36:8000/api';\r\n    }\r\n\r\n    // Default to localhost for local development (host port maps 8087->8000)\r\n    return 'http://localhost:8087/api';\r\n};\r\n\r\nconst getWSURL = () => {\r\n    if (process.env.REACT_APP_WS_URL) {\r\n        return process.env.REACT_APP_WS_URL;\r\n    }\r\n\r\n    const hostname = window.location.hostname;\r\n    if (hostname === 'home-hub' || hostname.includes('taimen-godzilla.ts.net')) {\r\n        return 'ws://home-hub-1:8000/ws';\r\n    }\r\n\r\n    if (hostname.startsWith('100.')) {\r\n        return 'ws://100.96.169.36:8000/ws';\r\n    }\r\n\r\n    // Default to localhost websocket (host port maps 8087->8000)\r\n    return 'ws://localhost:8087/ws';\r\n};\r\n\r\nconst API_BASE_URL = getAPIBaseURL();\r\nconst WS_URL = getWSURL();\r\n\r\n// Token management\r\nconst TOKEN_KEY = 'admin_panel_token';\r\n\r\nexport const getToken = () => localStorage.getItem(TOKEN_KEY);\r\nexport const setToken = (token) => localStorage.setItem(TOKEN_KEY, token);\r\nexport const removeToken = () => localStorage.removeItem(TOKEN_KEY);\r\n\r\n/**\r\n * Make authenticated API request\r\n */\r\nexport const apiRequest = async (endpoint, options = {}) => {\r\n    const token = getToken();\r\n\r\n    const config = {\r\n        ...options,\r\n        headers: {\r\n            'Content-Type': 'application/json',\r\n            ...(token && { 'Authorization': `Bearer ${token}` }),\r\n            ...options.headers,\r\n        },\r\n    };\r\n\r\n    try {\r\n        const response = await fetch(`${API_BASE_URL}${endpoint}`, config);\r\n\r\n        // Handle 401 - only redirect to login if not on Tailscale\r\n        if (response.status === 401) {\r\n            const hostname = window.location.hostname;\r\n            const isTailscale = hostname === 'home-hub' ||\r\n                hostname.includes('taimen-godzilla.ts.net') ||\r\n                hostname.startsWith('100.');\r\n\r\n            removeToken();\r\n\r\n            // Don't redirect on Tailscale - auto-login will handle it\r\n            if (!isTailscale) {\r\n                window.location.href = '/login';\r\n            }\r\n            throw new Error('Session expired. Please login again.');\r\n        }\r\n\r\n        if (!response.ok) {\r\n            const error = await response.json().catch(() => ({ message: 'Request failed' }));\r\n            throw new Error(error.message || `HTTP ${response.status}`);\r\n        }\r\n\r\n        return await response.json();\r\n    } catch (error) {\r\n        console.error('API Error:', error);\r\n        throw error;\r\n    }\r\n};\r\n\r\n/**\r\n * API Methods\r\n */\r\nexport const api = {\r\n    // Authentication\r\n    auth: {\r\n        login: async (email, password) => {\r\n            const response = await apiRequest('/auth/login', {\r\n                method: 'POST',\r\n                body: JSON.stringify({ email, password }),\r\n            });\r\n            if (response.access_token) {\r\n                setToken(response.access_token);\r\n            }\r\n            return response;\r\n        },\r\n\r\n        logout: async () => {\r\n            await apiRequest('/auth/logout', { method: 'POST' });\r\n            removeToken();\r\n        },\r\n\r\n        getProfile: async () => {\r\n            return await apiRequest('/auth/profile');\r\n        },\r\n    },\r\n\r\n    // Users\r\n    users: {\r\n        getAll: async () => {\r\n            return await apiRequest('/users');\r\n        },\r\n\r\n        getById: async (id) => {\r\n            return await apiRequest(`/users/${id}`);\r\n        },\r\n\r\n        create: async (userData) => {\r\n            return await apiRequest('/users', {\r\n                method: 'POST',\r\n                body: JSON.stringify(userData),\r\n            });\r\n        },\r\n\r\n        update: async (id, userData) => {\r\n            return await apiRequest(`/users/${id}`, {\r\n                method: 'PUT',\r\n                body: JSON.stringify(userData),\r\n            });\r\n        },\r\n\r\n        delete: async (id) => {\r\n            return await apiRequest(`/users/${id}`, {\r\n                method: 'DELETE',\r\n            });\r\n        },\r\n\r\n        suspend: async (id) => {\r\n            return await apiRequest(`/users/${id}/suspend`, {\r\n                method: 'PATCH',\r\n            });\r\n        },\r\n\r\n        activate: async (id) => {\r\n            return await apiRequest(`/users/${id}/activate`, {\r\n                method: 'PATCH',\r\n            });\r\n        },\r\n    },\r\n\r\n    // Chat\r\n    chat: {\r\n        getThreads: async () => {\r\n            return await apiRequest('/chat/threads');\r\n        },\r\n\r\n        createThread: async (threadData) => {\r\n            return await apiRequest('/chat/threads', {\r\n                method: 'POST',\r\n                body: JSON.stringify(threadData),\r\n            });\r\n        },\r\n\r\n        getMessages: async (threadId) => {\r\n            return await apiRequest(`/chat/threads/${threadId}/messages`);\r\n        },\r\n\r\n        sendMessage: async (threadId, text) => {\r\n            return await apiRequest(`/chat/threads/${threadId}/messages`, {\r\n                method: 'POST',\r\n                body: JSON.stringify({ text, threadId }),\r\n            });\r\n        },\r\n\r\n        deleteThread: async (threadId) => {\r\n            return await apiRequest(`/chat/threads/${threadId}`, {\r\n                method: 'DELETE',\r\n            });\r\n        },\r\n    },\r\n\r\n    // Invites\r\n    invites: {\r\n        getAll: async () => {\r\n            return await apiRequest('/invites');\r\n        },\r\n\r\n        create: async (maxUses = 5) => {\r\n            return await apiRequest('/invites', {\r\n                method: 'POST',\r\n                body: JSON.stringify({ max_uses: maxUses }),\r\n            });\r\n        },\r\n\r\n        revoke: async (id) => {\r\n            return await apiRequest(`/invites/${id}/revoke`, {\r\n                method: 'PATCH',\r\n            });\r\n        },\r\n\r\n        delete: async (id) => {\r\n            return await apiRequest(`/invites/${id}`, {\r\n                method: 'DELETE',\r\n            });\r\n        },\r\n    },\r\n\r\n    // Connections\r\n    connections: {\r\n        getAll: async () => {\r\n            return await apiRequest('/connections');\r\n        },\r\n\r\n        updateTailscale: async (config) => {\r\n            return await apiRequest('/connections/tailscale', {\r\n                method: 'PUT',\r\n                body: JSON.stringify(config),\r\n            });\r\n        },\r\n\r\n        testTailscale: async () => {\r\n            return await apiRequest('/connections/tailscale/test', {\r\n                method: 'POST',\r\n            });\r\n        },\r\n\r\n        updateOpenAI: async (config) => {\r\n            return await apiRequest('/connections/openai', {\r\n                method: 'PUT',\r\n                body: JSON.stringify(config),\r\n            });\r\n        },\r\n\r\n        testOpenAI: async () => {\r\n            return await apiRequest('/connections/openai/test', {\r\n                method: 'POST',\r\n            });\r\n        },\r\n\r\n        updateOllama: async (config) => {\r\n            return await apiRequest('/connections/ollama', {\r\n                method: 'PUT',\r\n                body: JSON.stringify(config),\r\n            });\r\n        },\r\n\r\n        testOllama: async () => {\r\n            return await apiRequest('/connections/ollama/test', {\r\n                method: 'POST',\r\n            });\r\n        },\r\n    },\r\n\r\n    // Cloud Storage\r\n    storage: {\r\n        getConfig: async () => {\r\n            return await apiRequest('/storage/config');\r\n        },\r\n\r\n        updateConfig: async (config) => {\r\n            return await apiRequest('/storage/config', {\r\n                method: 'PUT',\r\n                body: JSON.stringify(config),\r\n            });\r\n        },\r\n\r\n        listFiles: async (path = '/') => {\r\n            return await apiRequest(`/storage/files?path=${encodeURIComponent(path)}`);\r\n        },\r\n\r\n        uploadFile: async (file, path = '/') => {\r\n            const formData = new FormData();\r\n            formData.append('file', file);\r\n            formData.append('path', path);\r\n\r\n            const token = getToken();\r\n            const response = await fetch(`${API_BASE_URL}/storage/upload`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    ...(token && { 'Authorization': `Bearer ${token}` }),\r\n                },\r\n                body: formData,\r\n            });\r\n\r\n            if (!response.ok) throw new Error('Upload failed');\r\n            return await response.json();\r\n        },\r\n\r\n        deleteFile: async (fileId) => {\r\n            return await apiRequest(`/storage/files/${fileId}`, {\r\n                method: 'DELETE',\r\n            });\r\n        },\r\n    },\r\n\r\n    // Settings\r\n    settings: {\r\n        get: async () => {\r\n            return await apiRequest('/settings');\r\n        },\r\n\r\n        update: async (settings) => {\r\n            return await apiRequest('/settings', {\r\n                method: 'PUT',\r\n                body: JSON.stringify(settings),\r\n            });\r\n        },\r\n\r\n        sendNotification: async (message, target = 'all') => {\r\n            return await apiRequest('/settings/notifications/send', {\r\n                method: 'POST',\r\n                body: JSON.stringify({ message, target }),\r\n            });\r\n        },\r\n    },\r\n\r\n    // System\r\n    system: {\r\n        getHealth: async () => {\r\n            return await apiRequest('/system/health');\r\n        },\r\n\r\n        getLogs: async (limit = 100) => {\r\n            return await apiRequest(`/system/logs?limit=${limit}`);\r\n        },\r\n\r\n        restart: async () => {\r\n            return await apiRequest('/system/restart', {\r\n                method: 'POST',\r\n            });\r\n        },\r\n\r\n        backup: async () => {\r\n            return await apiRequest('/system/backup', {\r\n                method: 'POST',\r\n            });\r\n        },\r\n\r\n        getMetrics: async () => {\r\n            return await apiRequest('/system/metrics');\r\n        },\r\n    },\r\n};\r\n\r\n/**\r\n * WebSocket Connection Manager\r\n */\r\nexport class WebSocketManager {\r\n    constructor() {\r\n        this.socket = null;\r\n        this.listeners = new Map();\r\n    }\r\n\r\n    connect(onMessage) {\r\n        const token = getToken();\r\n        if (!token) {\r\n            console.warn('No token available for WebSocket connection');\r\n            return;\r\n        }\r\n\r\n        this.socket = new WebSocket(`${WS_URL}?token=${token}`);\r\n\r\n        this.socket.onopen = () => {\r\n            console.log('✅ WebSocket connected');\r\n        };\r\n\r\n        this.socket.onmessage = (event) => {\r\n            try {\r\n                const data = JSON.parse(event.data);\r\n                if (onMessage) onMessage(data);\r\n\r\n                // Notify listeners\r\n                this.listeners.forEach((callback) => callback(data));\r\n            } catch (error) {\r\n                console.error('WebSocket message error:', error);\r\n            }\r\n        };\r\n\r\n        this.socket.onerror = (error) => {\r\n            console.error('WebSocket error:', error);\r\n        };\r\n\r\n        this.socket.onclose = () => {\r\n            console.log('❌ WebSocket disconnected');\r\n            // Attempt reconnect after 3 seconds\r\n            setTimeout(() => this.connect(onMessage), 3000);\r\n        };\r\n    }\r\n\r\n    send(type, data) {\r\n        if (this.socket && this.socket.readyState === WebSocket.OPEN) {\r\n            this.socket.send(JSON.stringify({ type, data }));\r\n        } else {\r\n            console.warn('WebSocket not connected');\r\n        }\r\n    }\r\n\r\n    addListener(id, callback) {\r\n        this.listeners.set(id, callback);\r\n    }\r\n\r\n    removeListener(id) {\r\n        this.listeners.delete(id);\r\n    }\r\n\r\n    disconnect() {\r\n        if (this.socket) {\r\n            this.socket.close();\r\n            this.socket = null;\r\n        }\r\n    }\r\n}\r\n\r\nexport default api;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}